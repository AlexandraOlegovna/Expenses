<head>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
</head>

<body>
<link href="static/tttt.css" rel="stylesheet">

<script>
$(function() {
  	$.post("/showexp", {})
	.done(function( data ) {
		// console.log(data[0]);
		var d = document;
		for (i = 0; i < data.length; i++) {
			d.getElementById('operation').value = data[i].ololo;
			d.getElementById('theme').value = data[i].theme;
			d.getElementById('item').value = data[i].item;
			d.getElementById('cost').value = data[i].cost;
			d.getElementById('date').value = data[i].date;
			addRow(false);
		}
	})
});
//Добавить параметры у функции и доп. параметр на добавление записи в базу
function addRow(flag)
{
	var d = document;
	var operation;
	var theme;
	var item;
	var cost;
	var date;

	// Считываем значения с формы
	operation = d.getElementById('operation').value;
	theme = d.getElementById('theme').value;
	item = d.getElementById('item').value;
	cost = d.getElementById('cost').value;
	date = d.getElementById('date').value;

	// Находим нужную таблицу
	var tbody = d.getElementById('dynamic').getElementsByTagName('TBODY')[0];

	// Создаем строку таблицы и добавляем ее
	var row = d.createElement("TR");
	tbody.appendChild(row);

	// Создаем ячейки в вышесозданной строке
	// и добавляем тх
	if (operation == '' || theme ==  '' || item == '' || cost ==  '' || date == '')
	{
		alert('Empty fields are unavailable');
	}
	else {
    var td1 = d.createElement("TD");
    var td2 = d.createElement("TD");
	var td3 = d.createElement("TD");
	var td4 = d.createElement("TD");
	var td5 = d.createElement("TD");

	row.appendChild(td1);
	row.appendChild(td2);
	row.appendChild(td3);
	row.appendChild(td4);
	row.appendChild(td5);

	// Наполняем ячейки
	td1.innerHTML = operation;
	td2.innerHTML = theme;
	td3.innerHTML = item;
	td4.innerHTML = cost;
	td5.innerHTML = date;

	if (flag)
		$.post( "/insert", {op: $("#operation" ).val(), theme: $("#theme" ).val(), item: $("#item" ).val(), cost: $("#cost" ).val(), date: $("#date").val()})

	d.getElementById('operation').value = "";
	d.getElementById('theme').value = "";
	d.getElementById('item').value = "";
	d.getElementById('cost').value = "";
	d.getElementById('date').value = "";

	}
}
</script>

<form action="" id="add_persons" method="post" onsubmit="addRow(true); return false;">
<div class="text-center">
        <button name="subm" class="submit">Add element</button>
</div>
<table id="dynamic" class="dynamic">
  <thead>
        <tr>
            <th scope="col">Operation</th>
			<th scope="col">Theme</th>
            <th scope="col">Item</th>
			<th scope="col">Cost</th>
            <th scope="col">Date</th>
        </tr>
  </thead>
  <tbody>
	<tr>
        <td>
			<select name="operation" id="operation">
                            <option value="+">+</option>
                            <option value="-">-</option>
                        </select>
        </td>
        <td>
            <input type="text" name="theme" id="theme" value="" size="12" tabindex="2" />
        </td>
        <td>
            <input type="text" name="item" id="item" value="" size="12" tabindex="3" />
        </td>
		<td>
            <input type="number" name="cost" id="cost" value="" size="6" tabindex="4" />
        </td>
		<td>
            <input type="date" name="date" id="date" value="" size="12"/>
        </td>
	</tr>
  </tbody>
</table>
</form>

</body>
</table>
</form>
</body>
